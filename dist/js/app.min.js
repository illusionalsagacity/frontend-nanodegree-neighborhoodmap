!function e(n,t,o){function r(a,u){if(!t[a]){if(!n[a]){var c="function"==typeof require&&require;if(!u&&c)return c(a,!0);if(i)return i(a,!0);var s=new Error("Cannot find module '"+a+"'");throw s.code="MODULE_NOT_FOUND",s}var f=t[a]={exports:{}};n[a][0].call(f.exports,function(e){var t=n[a][1][e];return r(t?t:e)},f,f.exports,e,n,t,o)}return t[a].exports}for(var i="function"==typeof require&&require,a=0;a<o.length;a++)r(o[a]);return r}({1:[function(e,n,t){var o=e("./viewmodel.js"),r=e("./photo.js"),i=e("./location.js"),a=e("./error.js");e("./offline.js");jQuery(function(e){"use strict";function n(n,o){e.ajax({data:{method:"flickr.photos.getInfo",api_key:l,format:"json",photo_id:n},dataType:"jsonp",jsonp:"jsoncallback",url:d}).done(function(e,n,r){t(e,o)}).fail(function(e,n,t){v.errors.push(new a("Flickr API Error","Could not retrieve Flickr search data."))})}function t(e,n){n.realname(e.photo.owner.realname),n.username(e.photo.owner.username),n.description(e.photo.description._content),v.photos.push(n)}function u(){e.ajax({data:{client_id:p,client_secret:h,ll:"37.8083,-122.4156",v:"20150717"},dataType:"jsonp",url:"https://api.foursquare.com/v2/venues/explore"}).done(function(e,n,t){c(e),v.createMarkers()}).fail(function(e,n,t){v.errors.push(new a("Foursquare API Error","Could not retrieve Foursquare data."))})}function c(n){e.each(n.response.groups[0].items,function(e,n){var t=n.venue.location.address+", "+n.venue.location.city+", "+n.venue.location.state+" "+n.venue.location.postalCode+", "+n.venue.location.country,o=[];n.venue.categories.forEach(function(e){o.push(e.name)});var r;r="undefined"!=typeof n.venue.categories?n.venue.categories[0].icon.prefix+"bg_32"+n.venue.categories[0].icon.suffix:"";var a=new i(n.venue.name,t,n.tips[0].text,n.venue.location.lat,n.venue.location.lng,n.venue.rating,n.venue.ratingColor,o,r);v.locations.push(a)})}function s(){e.ajax({data:{method:"flickr.photos.search",api_key:l,safe_search:1,content_type:1,woe_id:28288708,format:"json",per_page:20},dataType:"jsonp",jsonp:"jsoncallback",url:"https://api.flickr.com/services/rest/"}).done(function(e,n,t){f(e)}).fail(function(e,n,t){v.errors.push(new a("Flickr API Error","Could not retrieve Flickr search data."))})}function f(t){e.each(t.photos.photo,function(e,t){var o=new r(t.farm,t.server,t.id,t.secret,"b","jpg");n(o.id(),o)}),v.photos.valueHasMutated()}var l="6b24b2e754fe7ea499e2db41d1daa866",d="https://api.flickr.com/services/rest",p="012MYNBUF2VK2SQK5C40HT0ZBX1255ZJGCG4XKYNTZ33DKE1",h="ZLIFE0L5WIZ21LUARPYY3OFFWCUWUU3IVR42IEUUREGHBL3F",v=new o;s(),u(),ko.applyBindings(v)})},{"./error.js":2,"./location.js":3,"./offline.js":4,"./photo.js":5,"./viewmodel.js":6}],2:[function(e,n,t){var o=function(e,n){"use strict";this.title=ko.observable(e),this.description=ko.observable(n)};n.exports=o},{}],3:[function(e,n,t){var o=function(e,n,t,o,r,i,a,u,c){"use strict";this.address=ko.observable(n),this.name=ko.observable(e),this.description=ko.observable(t),this.lat=ko.observable(o),this.lng=ko.observable(r),this.rating=ko.observable(i),this.ratingColor=ko.observable(a),this.category=ko.observableArray(u),this.iconURL=ko.observable(c)};n.exports=o},{}],4:[function(e,n,t){(function(){var e,n,t,o,r,i,a;o=function(e,n){var t,o,r,i;r=[];for(o in n.prototype)try{i=n.prototype[o],null==e[o]&&"function"!=typeof i?r.push(e[o]=i):r.push(void 0)}catch(a){t=a}return r},e={},null==e.options&&(e.options={}),t={checks:{xhr:{url:function(){return"/favicon.ico?_="+Math.floor(1e9*Math.random())},timeout:5e3},image:{url:function(){return"/favicon.ico?_="+Math.floor(1e9*Math.random())}},active:"xhr"},checkOnLoad:!1,interceptRequests:!0,reconnect:!0},r=function(e,n){var t,o,r,i,a,u;for(t=e,u=n.split("."),o=r=0,i=u.length;i>r&&(a=u[o],t=t[a],"object"==typeof t);o=++r);return o===u.length-1?t:void 0},e.getOption=function(n){var o,i;return i=null!=(o=r(e.options,n))?o:r(t,n),"function"==typeof i?i():i},"function"==typeof window.addEventListener&&window.addEventListener("online",function(){return setTimeout(e.confirmUp,100)},!1),"function"==typeof window.addEventListener&&window.addEventListener("offline",function(){return e.confirmDown()},!1),e.state="up",e.markUp=function(){return e.trigger("confirmed-up"),"up"!==e.state?(e.state="up",e.trigger("up")):void 0},e.markDown=function(){return e.trigger("confirmed-down"),"down"!==e.state?(e.state="down",e.trigger("down")):void 0},i={},e.on=function(n,t,o){var r,a,u,c,s;if(a=n.split(" "),a.length>1){for(s=[],u=0,c=a.length;c>u;u++)r=a[u],s.push(e.on(r,t,o));return s}return null==i[n]&&(i[n]=[]),i[n].push([o,t])},e.off=function(e,n){var t,o,r,a,u;if(null!=i[e]){if(n){for(r=0,u=[];r<i[e].length;)a=i[e][r],o=a[0],t=a[1],t===n?u.push(i[e].splice(r,1)):u.push(r++);return u}return i[e]=[]}},e.trigger=function(e){var n,t,o,r,a,u,c;if(null!=i[e]){for(a=i[e],c=[],o=0,r=a.length;r>o;o++)u=a[o],n=u[0],t=u[1],c.push(t.call(n));return c}},n=function(e,n,t){var o,r,i,a,u;return u=function(){return e.status&&e.status<12e3?n():t()},null===e.onprogress?(o=e.onerror,e.onerror=function(){return t(),"function"==typeof o?o.apply(null,arguments):void 0},a=e.ontimeout,e.ontimeout=function(){return t(),"function"==typeof a?a.apply(null,arguments):void 0},r=e.onload,e.onload=function(){return u(),"function"==typeof r?r.apply(null,arguments):void 0}):(i=e.onreadystatechange,e.onreadystatechange=function(){return 4===e.readyState?u():0===e.readyState&&t(),"function"==typeof i?i.apply(null,arguments):void 0})},e.checks={},e.checks.xhr=function(){var t,o;o=new XMLHttpRequest,o.offline=!1,o.open("HEAD",e.getOption("checks.xhr.url"),!0),null!=o.timeout&&(o.timeout=e.getOption("checks.xhr.timeout")),n(o,e.markUp,e.markDown);try{o.send()}catch(r){t=r,e.markDown()}return o},e.checks.image=function(){var n;return n=document.createElement("img"),n.onerror=e.markDown,n.onload=e.markUp,void(n.src=e.getOption("checks.image.url"))},e.checks.down=e.markDown,e.checks.up=e.markUp,e.check=function(){return e.trigger("checking"),e.checks[e.getOption("checks.active")]()},e.confirmUp=e.confirmDown=e.check,e.onXHR=function(e){var n,t,r;return r=function(n,t){var o;return o=n.open,n.open=function(r,i,a,u,c){return e({type:r,url:i,async:a,flags:t,user:u,password:c,xhr:n}),o.apply(n,arguments)}},t=window.XMLHttpRequest,window.XMLHttpRequest=function(e){var n,o,i;return i=new t(e),r(i,e),o=i.setRequestHeader,i.headers={},i.setRequestHeader=function(e,n){return i.headers[e]=n,o.call(i,e,n)},n=i.overrideMimeType,i.overrideMimeType=function(e){return i.mimeType=e,n.call(i,e)},i},o(window.XMLHttpRequest,t),null!=window.XDomainRequest?(n=window.XDomainRequest,window.XDomainRequest=function(){var e;return e=new n,r(e),e},o(window.XDomainRequest,n)):void 0},a=function(){return e.getOption("interceptRequests")&&e.onXHR(function(t){var o;return o=t.xhr,o.offline!==!1?n(o,e.markUp,e.confirmDown):void 0}),e.getOption("checkOnLoad")?e.check():void 0},setTimeout(a,0),window.Offline=e}).call(this),function(){var e,n,t,o,r,i,a,u,c;if(!window.Offline)throw new Error("Offline Reconnect brought in without offline.js");o=Offline.reconnect={},i=null,r=function(){var e;return null!=o.state&&"inactive"!==o.state&&Offline.trigger("reconnect:stopped"),o.state="inactive",o.remaining=o.delay=null!=(e=Offline.getOption("reconnect.initialDelay"))?e:3},n=function(){var e,n;return e=null!=(n=Offline.getOption("reconnect.delay"))?n:Math.min(Math.ceil(1.5*o.delay),3600),o.remaining=o.delay=e},a=function(){return"connecting"!==o.state?(o.remaining-=1,Offline.trigger("reconnect:tick"),0===o.remaining?u():void 0):void 0},u=function(){return"waiting"===o.state?(Offline.trigger("reconnect:connecting"),o.state="connecting",Offline.check()):void 0},e=function(){return Offline.getOption("reconnect")?(r(),o.state="waiting",Offline.trigger("reconnect:started"),i=setInterval(a,1e3)):void 0},c=function(){return null!=i&&clearInterval(i),r()},t=function(){return Offline.getOption("reconnect")&&"connecting"===o.state?(Offline.trigger("reconnect:failure"),o.state="waiting",n()):void 0},o.tryNow=u,r(),Offline.on("down",e),Offline.on("confirmed-down",t),Offline.on("up",c)}.call(this),function(){var e,n,t,o,r,i;if(!window.Offline)throw new Error("Requests module brought in without offline.js");t=[],i=!1,o=function(e){return Offline.trigger("requests:capture"),"down"!==Offline.state&&(i=!0),t.push(e)},r=function(e){var n,t,o,r,i,a,u,c,s;s=e.xhr,a=e.url,i=e.type,u=e.user,o=e.password,n=e.body,s.abort(),s.open(i,a,!0,u,o),r=s.headers;for(t in r)c=r[t],s.setRequestHeader(t,c);return s.mimeType&&s.overrideMimeType(s.mimeType),s.send(n)},e=function(){return t=[]},n=function(){var n,o,i,a,u,c;for(Offline.trigger("requests:flush"),u={},n=0,i=t.length;i>n;n++)a=t[n],c=a.url.replace(/(\?|&)_=[0-9]+/,function(e,n){return"?"===n?n:""}),u[a.type.toUpperCase()+" - "+c]=a;for(o in u)a=u[o],r(a);return e()},setTimeout(function(){return Offline.getOption("requests")!==!1?(Offline.on("confirmed-up",function(){return i?(i=!1,e()):void 0}),Offline.on("up",n),Offline.on("down",function(){return i=!1}),Offline.onXHR(function(e){var n,t,r,i,a;return a=e.xhr,r=e.async,a.offline!==!1&&(i=function(){return o(e)},t=a.send,a.send=function(n){return e.body=n,t.apply(a,arguments)},r)?null===a.onprogress?(a.addEventListener("error",i,!1),a.addEventListener("timeout",i,!1)):(n=a.onreadystatechange,a.onreadystatechange=function(){return 0===a.readyState?i():4===a.readyState&&(0===a.status||a.status>=12e3)&&i(),"function"==typeof n?n.apply(null,arguments):void 0}):void 0}),Offline.requests={flush:n,clear:e}):void 0},0)}.call(this),function(){var e,n,t,o,r;if(!Offline)throw new Error("Offline simulate brought in without offline.js");for(o=["up","down"],n=0,t=o.length;t>n;n++)r=o[n],(document.querySelector("script[data-simulate='"+r+"']")||localStorage.OFFLINE_SIMULATE===r)&&(null==Offline.options&&(Offline.options={}),null==(e=Offline.options).checks&&(e.checks={}),Offline.options.checks.active=r)}.call(this),function(){var e,n,t,o,r,i,a,u,c,s,f,l,d;if(!window.Offline)throw new Error("Offline UI brought in without offline.js");n='<div class="offline-ui"><div class="offline-ui-content"></div></div>',e='<a href class="offline-ui-retry"></a>',i=function(e){var n;return n=document.createElement("div"),n.innerHTML=e,n.children[0]},a=r=null,o=function(e){return f(e),a.className+=" "+e},f=function(e){return a.className=a.className.replace(new RegExp("(^| )"+e.split(" ").join("|")+"( |$)","gi")," ")},c={},u=function(e,n){return o(e),null!=c[e]&&clearTimeout(c[e]),c[e]=setTimeout(function(){return f(e),delete c[e]},1e3*n)},d=function(e){var n,t,o,r;o={day:86400,hour:3600,minute:60,second:1};for(t in o)if(n=o[t],e>=n)return r=Math.floor(e/n),[r,t];return["now",""]},l=function(){var t,u;return a=i(n),document.body.appendChild(a),null!=Offline.reconnect&&Offline.getOption("reconnect")&&(a.appendChild(i(e)),t=a.querySelector(".offline-ui-retry"),u=function(e){return e.preventDefault(),Offline.reconnect.tryNow()},null!=t.addEventListener?t.addEventListener("click",u,!1):t.attachEvent("click",u)),o("offline-ui-"+Offline.state),r=a.querySelector(".offline-ui-content")},s=function(){return l(),Offline.on("up",function(){return f("offline-ui-down"),o("offline-ui-up"),u("offline-ui-up-2s",2),u("offline-ui-up-5s",5)}),Offline.on("down",function(){return f("offline-ui-up"),o("offline-ui-down"),u("offline-ui-down-2s",2),u("offline-ui-down-5s",5)}),Offline.on("reconnect:connecting",function(){return o("offline-ui-connecting"),f("offline-ui-waiting")}),Offline.on("reconnect:tick",function(){var e,n,t;return o("offline-ui-waiting"),f("offline-ui-connecting"),e=d(Offline.reconnect.remaining),n=e[0],t=e[1],r.setAttribute("data-retry-in-value",n),r.setAttribute("data-retry-in-unit",t)}),Offline.on("reconnect:stopped",function(){return f("offline-ui-connecting offline-ui-waiting"),r.setAttribute("data-retry-in-value",null),r.setAttribute("data-retry-in-unit",null)}),Offline.on("reconnect:failure",function(){return u("offline-ui-reconnect-failed-2s",2),u("offline-ui-reconnect-failed-5s",5)}),Offline.on("reconnect:success",function(){return u("offline-ui-reconnect-succeeded-2s",2),u("offline-ui-reconnect-succeeded-5s",5)})},"complete"===document.readyState?s():null!=document.addEventListener?document.addEventListener("DOMContentLoaded",s,!1):(t=document.onreadystatechange,document.onreadystatechange=function(){return"complete"===document.readyState&&s(),"function"==typeof t?t.apply(null,arguments):void 0})}.call(this)},{}],5:[function(e,n,t){var o=function(e,n,t,o,r,i,a,u,c){"use strict";this.farm=ko.observable(e),this.server=ko.observable(n),this.id=ko.observable(t),this.secret=ko.observable(o),this.size=ko.observable(r),this.fileext=ko.observable(i),this.realname=ko.observable(a),this.username=ko.observable(u),this.description=ko.observable(c),this.url=ko.computed(function(){return"https://farm"+this.farm()+".staticflickr.com/"+this.server()+"/"+this.id()+"_"+this.secret()+"_"+this.size()+"."+this.fileext()},this)};n.exports=o},{}],6:[function(e,n,t){var o=function(){"use strict";var e=this;e.appName="Neighborhood Map",e.latitude=37.8083,e.longitude=-122.4156,e.searchTerm=ko.observable(),e.photos=ko.observableArray(),e.locations=ko.observableArray(),e.filteredLocations=ko.computed(function(){return e.searchTerm()?ko.utils.arrayFilter(e.locations(),function(n){return n.name().toLowerCase().indexOf(e.searchTerm().toLowerCase())>=0}):e.locations()}),e.filteredLocations.subscribe(function(n){e.createMarkers()}),e.errors=ko.observableArray();var n,t,o,r=new google.maps.LatLng(37.8083,-122.4156),i={center:r,draggable:!0,disableDefaultUI:!0,disableDoubleClickZoom:!0,scrollwheel:!1,panControl:!1,zoom:17,zoomControl:!1},a=[],u=new google.maps.Map(document.getElementById("map-canvas"),i);e.createMarkers=function(){a.forEach(function(e){e.setMap(null)}),a.length=0,ko.utils.arrayForEach(e.filteredLocations(),function(e){var r=new google.maps.Marker({position:new google.maps.LatLng(e.lat(),e.lng()),map:u,title:e.name(),icon:e.iconURL()}),i='<div id="content"><div id="siteNotice"><h1 id="firstHeading" class="firstHeading">'+e.name()+'</h1><div id="bodyContent"><p>'+e.description()+"</p><p>"+e.address()+"</p></div></div>",c=new google.maps.InfoWindow({content:i,maxWidth:400});google.maps.event.addListener(r,"click",function(){o&&o.close(),c.open(u,r),o=c,t&&t.setIcon(n),n=r.getIcon(),r.setIcon("img/pin66.png"),t=r}),a.push(r)})}};n.exports=o},{}]},{},[1]);