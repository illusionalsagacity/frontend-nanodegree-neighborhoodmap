jQuery(function(e){"use strict";function o(o,s){e.ajax({data:{method:"flickr.photos.getInfo",api_key:h,format:"json",photo_id:o},dataType:"jsonp",jsonp:"jsoncallback",url:p,success:function(e){t(e,s)},error:function(e,o,t){b.errors.push(new i("Flickr API Error","Could not retrieve Flickr search data."))}})}function t(e,o){o.realname(e.photo.owner.realname),o.username(e.photo.owner.username),o.description(e.photo.description._content),b.photos.push(o)}function s(){e.ajax({data:{client_id:d,client_secret:v,ll:"37.8083,-122.4156",v:"20150717"},dataType:"jsonp",url:"https://api.foursquare.com/v2/venues/explore",success:r,error:function(e,o,t){b.errors.push(new i("Foursquare API Error","Could not retrieve Foursquare data."))}}).done(function(){b.createMarkers()})}function r(o){e.each(o.response.groups[0].items,function(e,o){var t=o.venue.location.address+", "+o.venue.location.city+", "+o.venue.location.state+" "+o.venue.location.postalCode+", "+o.venue.location.country,s=[];o.venue.categories.forEach(function(e){s.push(e.name)});var r;r="undefined"!=typeof o.venue.categories?o.venue.categories[0].icon.prefix+"bg_32"+o.venue.categories[0].icon.suffix:"";var a=new c(o.venue.name,t,o.tips[0].text,o.venue.location.lat,o.venue.location.lng,o.venue.rating,s,r);b.locations.push(a)})}function a(){e.ajax({data:{method:"flickr.photos.search",api_key:h,safe_search:1,content_type:1,woe_id:28288708,format:"json",per_page:20},dataType:"jsonp",jsonp:"jsoncallback",url:"https://api.flickr.com/services/rest/",success:u,error:function(e,o,t){b.errors.push(new i("Flickr API Error","Could not retrieve Flickr search data."))}})}function n(){this.appName="Neighborhood Map",this.latitude=37.8083,this.longitude=-122.4156,this.searchTerm=ko.observable(),this.photos=ko.observableArray(),this.locations=ko.observableArray(),this.errors=ko.observableArray();var o,t,s,r=new google.maps.LatLng(37.8083,-122.4156),a={center:r,draggable:!0,disableDefaultUI:!0,disableDoubleClickZoom:!0,scrollwheel:!1,panControl:!1,zoom:17,zoomControl:!1},n=new google.maps.Map(document.getElementById("map-canvas"),a);this.searchFor=function(o){var t=e("#search",o).val();console.log(t),alert(t)},this.createMarkers=function(){this.locations().forEach(function(e){var r=new google.maps.Marker({position:new google.maps.LatLng(e.lat(),e.lng()),map:n,title:e.name(),icon:e.iconURL()}),a='<div id="content"><div id="siteNotice"><h1 id="firstHeading" class="firstHeading">'+e.name()+'</h1><div id="bodyContent"><p>'+e.description()+"</p><p>"+e.address()+"</p></div></div>",i=new google.maps.InfoWindow({content:a,maxWidth:400});google.maps.event.addListener(r,"click",function(){s&&s.close(),i.open(n,r),s=i,t&&t.setIcon(o),o=r.getIcon(),r.setIcon("img/pin66.png"),t=r})})}}function i(e,o){this.title=ko.observable(e),this.description=ko.observable(o)}function c(e,o,t,s,r,a,n,i){this.address=ko.observable(o),this.name=ko.observable(e),this.description=ko.observable(t),this.lat=ko.observable(s),this.lng=ko.observable(r),this.rating=ko.observable(a),this.category=ko.observableArray(n),this.iconURL=ko.observable(i)}function l(e,o,t,s,r,a,n,i,c){this.farm=ko.observable(e),this.server=ko.observable(o),this.id=ko.observable(t),this.secret=ko.observable(s),this.size=ko.observable(r),this.fileext=ko.observable(a),this.realname=ko.observable(n),this.username=ko.observable(i),this.description=ko.observable(c),this.url=ko.computed(function(){return"https://farm"+this.farm()+".staticflickr.com/"+this.server()+"/"+this.id()+"_"+this.secret()+"_"+this.size()+"."+this.fileext()},this)}function u(t){e.each(t.photos.photo,function(e,t){var s=new l(t.farm,t.server,t.id,t.secret,"b","jpg");o(s.id(),s)}),b.photos.valueHasMutated()}var h="6b24b2e754fe7ea499e2db41d1daa866",p="https://api.flickr.com/services/rest",d="012MYNBUF2VK2SQK5C40HT0ZBX1255ZJGCG4XKYNTZ33DKE1",v="ZLIFE0L5WIZ21LUARPYY3OFFWCUWUU3IVR42IEUUREGHBL3F",b=new n;a(),s(),ko.applyBindings(b)});