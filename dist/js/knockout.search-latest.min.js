function implode(t,a){var e="",r="",i="";if(1===arguments.length&&(a=t,t=""),"object"==typeof a){if("[object Array]"===Object.prototype.toString.call(a))return a.join(t);for(e in a)r+=i+a[e],i=t;return r}return a}!function(t){"function"==typeof require&&"object"==typeof exports&&"object"==typeof module?t(require("knockout"),exports):"function"==typeof define&&define.amd?define(["knockout","exports"],t):t(ko,ko.search={})}(function(t,a){ko.search={_data:[],_tempData:[],_removeData:[],_isJson:!1,_query:new Array(5),_resortResult:!1,_sortFilter:"",_callbackFlag:!1,_callback:null,_dataType:"",_isJson:function(t){try{JSON.parse(t)}catch(a){return!1}return!0},_reset:function(){this._tempData=this._data,this._removeData=[],this._resortResult=!1},_search:function(t,a){var e=[],r=ko.utils.arrayFilter(a,function(a){for(var r in t)if(t.hasOwnProperty(r)){var i=ko.unwrap(a[r]);if("number"==typeof t[r]||"string"==typeof t[r]){if(i!==t[r])return e.push(a),!1}else{if(!(t[r]instanceof Array)){var s=t[r],n=!1;switch(s.condition){case"==":n=i==s.value;break;case"!=":n=i!=s.value;break;case"===":n=i===s.value;break;case"!==":n=i!==s.value;break;case"<":n=i<s.value;break;case">":n=i>s.value;break;case"<=":n=i<=s.value;break;case">=":n=i>=s.value}return n||e.push(a),n}if(-1==t[r].indexOf(i))return e.push(a),!1}}return!0});return this._removeData=e,r},_sort:function(t,a){var e=a?1:-1,r=a?-1:1;return function(a,i){return a[t]<i[t]?e:a[t]>i[t]?r:0}},_resort:function(t,a,e){for(var r=0,i=t[r][this._sortFilter],s=r+1;s<t.length;s++)if(t[s][this._sortFilter]!==i){var n=t.slice(r,s);n=n.sort(this._sort(a,e));var u=[r,s-r];u.push.apply(u,n),Array.prototype.splice.apply(t,u),r=s,i=t[s][this._sortFilter]}return t},_runCallback:function(){this._callbackFlag&&(this._callback.call(),this._callbackFlag=!1)},_LoadData:function(t){return this._data=t,this._isJson(this._data)?(this._isJson=!0,this._dataType="JSON String ",this._tempData=JSON.parse(this._data)):this._data instanceof Array||"object"==typeof this._data?(this._tempData=this._data,this._dataType="Array"):console.log("Invalid data provided"),this._query[0]={prop:"Query Log",value:"Generated Query Result",Active:!0},this._query[1]={prop:"Columns",value:"*",Active:!0},this._query[2]={prop:"From",value:this._dataType,Active:!0},this},select:function(t){if(t instanceof Array){var a="";a+=implode(" , ",t);var e=[],r=this._tempData;ko.utils.arrayForEach(r,function(a){var r={};ko.utils.arrayForEach(t,function(t){a[t]&&(r[t]=a[t])}),e.push(r)}),this._query[1]={prop:"Columns",value:a,Active:!0},this._tempData=e}else console.log("Please select columns in array format");return this},filter:function(t){var a=this._tempData,e=[];return e=t instanceof Array?a.reduce(function(t,e,r,i){return t.concat(this._search(e,a))},[]):this._search(t,a),this._tempData=e,this},limit:function(t){var a=this._tempData.slice(0,t);return this._query.push({prop:"Limit",value:t,Active:!0}),this._tempData=a,this},start:function(t){var a=this._tempData.slice(t);return this._query.push({prop:"Start",value:t,Active:!0}),this._tempData=a,this},count:function(){var t=ko.mapping.toJS(this._tempData);return this._query.push({prop:"Total",value:t.length,Active:!0}),t.length},first:function(t){var a=this._tempData;return this._tempData=t?a.slice(0,1):a[0],this._query.push({prop:"First",value:1,Active:!0}),this},last:function(t){var a=this._tempData,e=this._tempData.length;return this._tempData=t?a.slice(e-1):a[e-1],this._query.push({prop:"Last",value:1,Active:!0}),this},order:function(t,a){var e=this._tempData;return a=a?!0:!1,this._resortResult?e=this._resort(e,t,a):e.sort(this._sort(t,a)),this._sortFilter=t,this._resortResult=!0,this._tempData=e,this._query.push({prop:"Order",value:t,Active:!0}),this._query.push({prop:"Order Reverse",value:a,Active:!0}),this},max:function(t){var a=this._tempData,e=[],r=a.map(function(a){return ko.unwrap(a[t])}),i=Math.max.apply(Math,r);return a.map(function(a){i==ko.unwrap(a[t])&&e.push(a)}),this._tempData=e,1==e.length&&(this._tempData=e[0]),this._query.push({prop:"Max",value:t,Active:!0}),this},min:function(t){var a=this._tempData,e=[],r=a.map(function(a){return ko.unwrap(a[t])}),i=Math.min.apply(Math,r);return a.map(function(a){i==ko.unwrap(a[t])&&e.push(a)}),this._tempData=e,1==e.length&&(this._tempData=e[0]),this._query.push({prop:"Min",value:t,Active:!0}),this},index:function(t){var a=this._tempData;return a.length>=t?(a&&a[t-1]&&(this._tempData=a[t-1]),this._query.push({prop:"Max/Min Record",value:t,Active:!0})):console.log("Invalid index provided"),this},remove:function(){return this._tempData=_removeData,this},query:function(){ko.utils.arrayForEach(this._query,function(t){t&&t.Active&&console.log(t.prop+" : "+t.value)})},callback:function(t){return this._callback=t,this._callbackFlag=!0,this},map:function(t){var a=this._tempData;return a.map(t),this._tempData=a,this},each:function(t){var a=this._tempData;return t.forEach(function(t){a.map(t)}),this._tempData=a,this},supplant:function(t){var a=this._tempData;return a.map(function(a){a.template=t.replace(/{(\w+)}/g,function(t,e){return a[e]})}),this._tempData=a,this},userData:function(){return this._tempData},setData:function(t){return this._LoadData(t)},get:function(t){var a=this._tempData;return this._runCallback(),this._reset(),t?ko.mapping.toJS(a):a},stringify:function(){var t=this._tempData;return this._runCallback(),this._reset(),JSON.stringify(ko.mapping.toJS(t))}}});